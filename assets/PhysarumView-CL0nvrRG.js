import{d as b,r as f,o as A,c as R,a as u,t as q,u as E,b as B,e as I}from"./index-D7cPqYep.js";const j={class:"w-full"},F={class:"absolute w-full"},N={class:"flex mx-2 my-1 justify-between"},W={class:"text-white font-bold"},L=b({__name:"PhysarumView",setup(G){const n=f();let y=f(0),P=f(1e3),w=f("#870391"),v=f(!1),h=f({angle:45,distance:10});const _=s=>{let c=[],t;s.setup=()=>{if(n.value){const o=s.createCanvas(n==null?void 0:n.value.clientWidth,n==null?void 0:n.value.clientHeight);s.angleMode(s.DEGREES),t=s.pixelDensity(),o.mouseClicked(D);for(let e=0;e<P.value;e++){let r=s.random(360),l=V("circle",20,s.width/2,s.height/2);c[e]={x:l.x,y:l.y,heading:r,vx:s.cos(r),vy:s.sin(r),rotAngle:45,sensors:{rSensorPos:s.createVector(0,0),lSensorPos:s.createVector(0,0),fSensorPos:s.createVector(0,0)}}}}},s.draw=()=>{s.background(0,5),s.loadPixels();for(let o=0;o<P.value;o++)C(k(c[o]));s.frameRate(60),y.value=Math.floor(s.frameRate())};function k(o){o.vx=s.cos(o.heading),o.vy=s.sin(o.heading),o.x=o.x+o.vx,o.y=o.y+o.vy,(o.x<50||o.y<50||o.x+50>s.width||o.y>s.height-50)&&(o.heading>180?o.heading=o.heading-180:o.heading=o.heading+180),o.sensors.rSensorPos=x(o,o.sensors.rSensorPos,h.value,o.heading+h.value.angle),o.sensors.lSensorPos=x(o,o.sensors.lSensorPos,h.value,o.heading-h.value.angle),o.sensors.fSensorPos=x(o,o.sensors.fSensorPos,h.value,o.heading);let e,r,l,i;return e=4*(t*s.floor(o.sensors.rSensorPos.y))*(t*s.width)+4*(t*s.floor(o.sensors.rSensorPos.x)),l=s.pixels[e],e=4*(t*s.floor(o.sensors.lSensorPos.y))*(t*s.width)+4*(t*s.floor(o.sensors.lSensorPos.x)),r=s.pixels[e],e=4*(t*s.floor(o.sensors.fSensorPos.y))*(t*s.width)+4*(t*s.floor(o.sensors.fSensorPos.x)),i=s.pixels[e],i>r&&i>l&&(o.heading+=0),i<r&&i<l&&(s.random(1)<.5?o.heading+=o.rotAngle:o.heading-=o.rotAngle),r>l&&(o.heading+=-o.rotAngle),l>r&&(o.heading+=o.rotAngle),o}function C(o){return s.noStroke(),s.stroke(w.value),s.strokeWeight(1),s.point(o.x,o.y),o}function D(){v.value&&s.noLoop(),v.value||s.loop(),v.value=!v.value}function x(o,e,r,l){return e.x=(o.x+r.distance*s.cos(l)+s.width)%s.width,e.y=(o.y+r.distance*s.sin(l)+s.height)%s.height,e}function V(o,e=1,r,l){let i={x:r,y:l};if(e===1&&o==="circle"&&(i=S(20,r,l)),e===1&&o==="square"&&(i=m(20,r,l)),e>1&&o==="circle"){let{x:d,y:a}=M(e,r,l);i=S(20,d,a)}if(e>1&&o==="square"){let{x:d,y:a}=M(e,r,l);i=m(20,d,a)}return i}function S(o,e,r){let l=Math.random()*2*Math.PI,i=Math.sqrt(Math.random())*o,d=Math.cos(l)*i,a=Math.sin(l)*i;return{x:e+d,y:r+a}}function m(o,e,r){return{x:s.random(e-o,e+20),y:s.random(r-o,r+20)}}function M(o,e,r){let l=[];for(let i=0;i<Math.PI*2;i+=Math.PI*2/o){let d=e+100*Math.sin(i),a=r+100*Math.cos(i);l.push({x:d,y:a})}return l[Math.floor(Math.random()*l.length)]}};return(s,c)=>{const t=I("P5Canvas");return A(),R("div",j,[u("div",null,[u("div",F,[u("div",N,[u("div",W,"FPS:"+q(E(y)),1),c[0]||(c[0]=u("div",null,null,-1))])]),u("div",{ref_key:"container",ref:n,class:"w-screen h-screen"},[B(t,{sketch:_})],512)])])}}});export{L as default};
